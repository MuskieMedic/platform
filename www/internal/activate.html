<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Activate | Syncloud</title>
	<meta name="author" content="feelspace.ru">
	<meta name="description" content="Your Personal Server">
	<meta name="keywords" content="Your Personal Server">
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
	<meta name="HandheldFriendly" content="true" />
	<meta name="MobileOptimized" content="width" />
	<meta content="yes" name="apple-mobile-web-app-capable" />
	

	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
	<link rel="manifest" href="/manifest.json">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#64bc46">
	<meta name="theme-color" content="#3e454e">
	
  <script type="text/javascript" src="js/lib/URI.js"></script>

	<link rel="stylesheet" href="css/site.min.css" type="text/css">

	<!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap-switch.min.css" rel="stylesheet">
    <link href="css/font-awesome.css" rel="stylesheet">

	</head>	
<body>
<div class="wrapper">
<div class="content">
<!--HEADER-->
	<div class="headblock">
		<header class="wd12">
			<div class="logo onelogo">Syncloud</div>
		</header>
	</div>
	<!--Login_block1-->
	<div class="block1 wd12" id="block1">
		<h1>Activate</h1>
		<div class="formblock">
			<form id="form_activate">
				<h2>Syncloud Account</h2>
				<input placeholder="syncloud.it email" class="emailinput" name="redirect_email" id="redirect_email" type="text">
				<input placeholder="syncloud.it password" class="passinput" name="redirect_password" id="redirect_password" type="password">
				<h2>Device Setup</h2>
				<input placeholder="Domain" class="domain" name="user_domain" id="user_domain" type="text"><span>.syncloud.it</span>
				<input placeholder="Login" class="nameinput" name="device_username" id="device_username" type="text">
				<input placeholder="Password" class="passinput" name="device_password" id="device_password" type="password">
				<button id="btn_activate" class="submit buttonblue" type="submit" data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> Activating...">Activate</button>
			</form>
		</div>
	</div>
</div>
</div>
<!-- Scripts-->
<script src="js/lib/jquery-1.11.3.min.js"></script>
<script src="js/lib/bootstrap.min.js"></script>
<script src="js/lib/bootstrap-switch.min.js"></script>
<script src="js/ui/font.js"></script>
<script src="js/ui/common.js"></script>

<!--[if lt IE 9]> 
<script src="js/lib/html5.js"></script>
<script src="js/lib/IE9.js"></script>
<![endif]-->

<script src="js/backend/common.js"></script>
<script src="js/backend/activate.js"></script>

<script type="text/javascript">

function ui_display_error(status, error) {
		if (error) {
				if ('parameters_messages' in error) {
						for (var i = 0; i < error.parameters_messages.length; i++) {
								var pm = error.parameters_messages[i];
								var message_text = pm.messages.join('\n');
								show_field_error(pm.parameter, message_text);
						}
				} else {
						if (!('message' in error && error.message)) {
								error['message'] = 'Server Error'
						}
				}
		} else {
				window.location.href = "error.html";
		}
}

$(document).ready(function () {
		$("#form_activate").submit(function (event) {
				event.preventDefault();

				var btn = $('#btn_activate');
				btn.button('loading');
				$("#form_activate input").prop("disabled", true);

				var values = $("#form_activate").serializeArray();

				backend.activate({
					values: values,
					always: function() {
						btn.button('reset');
						$("#form_activate input").prop("disabled", false);
					},
					done: function() {
        		window.location.href = "login.html";
					},
					fail: function(status, error) {
						ui_display_error(error);
					}
				});
		});
});
</script>

<!-- END SCRIPTS -->
</body>
</html>