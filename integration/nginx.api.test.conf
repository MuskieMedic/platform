user root;

worker_processes 4;

pid {{ app_data }}/nginx.pid;
error_log {{ app_data }}/nginx_error.log warn;

events {
    worker_connections 1024;
}

http {
    access_log {{ platform_data }}/log/test_nginx_api_access.log;
    
    server {
        listen 82;
        server_name test;

        location / {
            proxy_set_header X-Forwarded-Proto $scheme ;
            proxy_set_header X-Forwarded-Host $http_host ;
            proxy_pass      http://unix:{{ platform_data }}/api.socket: ;
            proxy_redirect  http://unix:{{ platform_data }}/api.socket: $scheme://$http_host ;
        }
    }
 }